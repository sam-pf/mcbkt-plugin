webpackJsonp([1],{133:function(e,t){},134:function(e,t){},135:function(e,t){},137:function(e,t,n){function o(e){r||n(133)}var r=!1,i=n(46)(n(75),n(139),o,"data-v-0df4abcc",null);i.options.__file="/home/gweon/sys/git/mcbkt-plugin/src/components/map_table_h.vue",i.esModule&&Object.keys(i.esModule).some(function(e){return"default"!==e&&"__"!==e.substr(0,2)})&&console.error("named exports are not supported in *.vue files."),i.options.functional&&console.error("[vue-loader] map_table_h.vue: functional components are not supported with templates, they should use render functions."),e.exports=i.exports},138:function(e,t,n){function o(e){r||n(135)}var r=!1,i=n(46)(n(76),n(141),o,"data-v-44d0497c",null);i.options.__file="/home/gweon/sys/git/mcbkt-plugin/src/components/panel.vue",i.esModule&&Object.keys(i.esModule).some(function(e){return"default"!==e&&"__"!==e.substr(0,2)})&&console.error("named exports are not supported in *.vue files."),i.options.functional&&console.error("[vue-loader] panel.vue: functional components are not supported with templates, they should use render functions."),e.exports=i.exports},139:function(e,t,n){e.exports={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("table",{staticClass:"table map_table_h"},[n("thead",[n("tr",e._l(e.keys,function(t){return n("th",[e._v(e._s(""+t))])}))]),e._v(" "),n("tbody",{attrs:{title:e.body_tooltip}},[n("tr",e._l(e.vals,function(t){return n("td",[e._v(e._s(""+t))])}))])])},staticRenderFns:[]},e.exports.render._withStripped=!0},140:function(e,t,n){e.exports={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("div",{attrs:{id:"app-innerframe"}},[n("router-view")],1)])},staticRenderFns:[]},e.exports.render._withStripped=!0},141:function(e,t,n){e.exports={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"mcbkt-panel"},[n("h1",[e._v(e._s(e._f("capitalize_all")(e.heading)))]),e._v(" "),n("h2",{staticClass:"curact"},[e._v("Current "+e._s(e._f("capitalize")(e.unit_activity_type)))]),e._v(" "),n("map_table_h",{attrs:{data:e.curitems,body_tooltip:e.body_tooltip_cur}}),e._v(" "),n("h2",{staticClass:"preact"},[e._v("Previous "+e._s(e._f("pluralize")(e._f("capitalize")(e.unit_activity_type))))]),e._v(" "),n("map_table_h",{attrs:{data:e.previtems}}),e._v(" "),n("h2",{staticClass:"allact"},[e._v("All "+e._s(e._f("pluralize")(e._f("capitalize")(e.unit_activity_type))))]),e._v(" "),n("map_table_h",{attrs:{data:e.allitems}})],1)},staticRenderFns:[]},e.exports.render._withStripped=!0},69:function(e,t,n){"use strict";/**
 * @file This module is for listening to log data generated by CODAP, do
 *    stuff on log data, and then possibly pushing the result back into CODAP
 *    log stream.
 *    <p><i>Thanks are due to Doug Martin and Jonathan Sandoe</i> for their
 *    code of DataflowGettingStarted data-interactive, which gave some
 *    initial guideline and some hints to the code of this file.</p>
 *
 * @copyright (c) 2017, Physics Front LLC (main@physicsfront.com)
 * @license <a href="https://www.apache.org/licenses/LICENSE-2.0">
 *    Apache License, Version 2.0</a> (also, see file NOTICE).
 * @author Sam Gweon (Sam@physicsfront.com)
 * @version 0.1.0
 * @module iframe-logdata-listener
 */
function o(e,t){var n=this,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Real Time MCBKT",r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if("string"!=typeof o)throw Error("** The value of title must be a string.");if(o=o.trim(),!o.length)throw Error("** The value of title cannot be an empty string.");if("function"!=typeof t)throw Error("** The value of logdata_callback must be a function.");var a=o+"--"+(new Date).getTime()+"--"+Math.round(1e10*Math.random()),s=a+"::",u=null,c={title:o,version:"0.1.0",preventBringToFront:!1,dimensions:{width:500,height:500}},l=function(){m(),w.disconnect()},d=function(e){return'Handler not implemented for action "'+e.action+'" for CODAP request with resource "'+e.resource+'".'},f=function(e){return'Handler not implemented for CODAP response to request "'+e.action+'" with resource "'+e.resource+'".'},p=function(e){var t=v[e];return void 0===t&&(t=function(){throw Error('No handler for CODAP request with resource "'+e+'".')}),t},h=function(e){var t=_[e];return void 0===t&&(t=function(){throw Error('No handler for CODAP response to request with resource "'+e+'".')}),t},v={interactiveState:function(e){switch(e.action){case"get":return c;default:throw Error(d(e))}},logMessageNotice:function(e){var n=e.values;switch(e.action){case"notify":return n.formatStr.startsWith(s)&&(r>=1?console.log("== got boomeranged logdata: "+i()(n)):n.logMonitor&&a==n.logMonitor.clientId&&(delete n.logMonitor,n.iframe_logdata_client_id=a,n.time=.001*(new Date).getTime(),t(n,g))),{message:"logdatum was received"};default:throw Error(d(e))}}},_={interactiveFrame:function(e,t){switch(e.action){case"get":var o=t.values;return n.set_state(o),void(o.savedState&&n.set_state(o.savedState,!1));default:throw Error(f(e))}},logMessage:function(e){switch(e.action){case"notify":return void(r>=1&&console.log("log data were recevied well by CODAP---but only formatStr and replaceArgs, I think."));default:throw Error(f(e))}},logMessageMonitor:function(e){switch(e.action){case"register":return void(r>=1&&console.log("== got register data: "+i()(e.values)));default:throw Error(d(e))}}},m=function(){n.send_request_to_codap({action:"unregister",resource:"logMessageMonitor",values:{clientId:a}})},g=function(e){void 0==e.formatStr&&(e.formatStr=o+" report"),r>=1&&console.log("== pushing logdata to CODAP: "+i()(e)),n.send_request_to_codap({action:"notify",resource:"logMessage",values:e})};this.handle_codap_request=function(e,t){r>=1&&console.log("== handle_codap_request: "+i()(e));var n=!1,o=null;try{o=p(e.resource)(e),n=!0}catch(e){console.log("** _get_codap_request_handler failed: "+e.message)}t({success:n,values:o})},this.handle_codap_response=function(e,t){if(r>=1&&console.log("== handle_codap_response: "+i()(t)),u=t,t)if(Array.isArray(t)){if(!Array.isArray(e))throw Error("Type mismatch between request (non-Array) and response (Array).");if(t.length!=e.length)throw Error("Length mismatch between request ("+e.length+") and response ("+t.length+").");e.forEach(function(e,o){return n.handle_codap_response(e,t[o])})}else if(t.success){r>=1&&console.log("== Request to CODAP succeeded: "+i()(e));try{h(e.resource)(e,t)}catch(e){console.log("** _get_codap_response_handler failed: "+e.message)}}else{var o="** Request to CODAP failed: "+i()(e);console.log(o),alert(o)}else console.log("** Request to CODAP seems to have gotten no response: "+i()(e))},this.send_request_to_codap=function(e,t){"logMessage"===e.resource&&"notify"===e.action&&(void 0!==e.values&&(e.values={}),e.values.formatStr=s+e.values.formatStr),w.call(e,function(o){return n.handle_codap_response(e,o,t)})},this.set_state=function(e){if(arguments.length>1&&void 0!==arguments[1]&&!arguments[1])for(var t in e)c[t]=e[t];else for(var n in c){var o=e[n];void 0!==o&&(c[n]=o)}},this.update_iframe_with_state=function(){n.send_request_to_codap({action:"update",resource:"interactiveFrame",values:c})};var w=new e.IframePhoneRpcEndpoint(this.handle_codap_request,"data-interactive",window.parent);this.send_request_to_codap({action:"get",resource:"interactiveFrame"}),function(){n.send_request_to_codap({action:"register",resource:"logMessageMonitor",values:{clientId:a,message:"*"}})}(),window.unload=l}var r=n(27),i=n.n(r);t.a=o},70:function(e,t,n){"use strict";(function(e,t){var o,o,r=n(81),i=n.n(r),a=n(82),s=n.n(a),u=n(27),c=n.n(u),l=n(49),d=n.n(l);!function(o){"object"==("undefined"==typeof exports?"undefined":d()(exports))?e.exports=o():"function"==typeof define&&n(144)?define(o):"undefined"!=typeof window?window.iframePhone=o():void 0!==t?t.iframePhone=o():"undefined"!=typeof self&&(self.iframePhone=o())}(function(){return function e(t,n,r){function i(s,u){if(!n[s]){if(!t[s]){var c="function"==typeof o&&o;if(!u&&c)return o(s,!0);if(a)return a(s,!0);throw new Error("Cannot find module '"+s+"'")}var l=n[s]={exports:{}};t[s][0].call(l.exports,function(e){var n=t[s][1][e];return i(n||e)},l,l.exports,e,t,n,r)}return n[s].exports}for(var a="function"==typeof o&&o,s=0;s<r.length;s++)i(r[s]);return i}({1:[function(e,t,n){function o(){function e(e){r.supported()?window.parent.postMessage(e,"*"):window.parent.postMessage(c()(e),"*")}function t(t,n){var o;o=1===arguments.length&&"object"===(void 0===t?"undefined":d()(t))&&"string"==typeof t.type?t:{type:t,content:n},y?e(o):b.push(o)}function n(){e({type:"hello"})}function o(e,t){g[e]=t}function u(){g={}}function l(){return s()(g)}function f(e){if(e.source===window.parent){var n=e.data;if("string"==typeof n&&(n=JSON.parse(n)),!y&&"hello"===n.type)for(y=!0,_();b.length>0;)t(b.shift());y&&g[n.type]&&g[n.type](n.content)}}function p(){y=!1,_(),window.removeEventListener("message",messsageListener)}function h(){w||(w=!0,window.parent!==window&&(v(),window.addEventListener("message",f,!1)))}function v(){m&&_(),m=window.setInterval(n,i),window.setTimeout(_,a),n()}function _(){window.clearInterval(m),m=null}var m,g={},w=!1,y=!1,b=[];return{initialize:h,getListenerNames:l,addListener:o,removeAllListeners:u,disconnect:p,post:t}}var r=e("./structured-clone"),i=200,a=6e4,u=null;t.exports=function(){return u||(u=new o),u}},{"./structured-clone":4}],2:[function(e,t,n){function o(){for(var e="abcdefghijklmnopqrstuvwxyz0123456789",t=e.length,n=[],o=0;o<10;o++)n.push(e[Math.floor(Math.random()*t)]);return n.join("")}var r=e("./parent-endpoint"),a=e("./iframe-endpoint");t.exports=function(e,t,n,s,u){function c(e,n){var r=o();f[r]={callback:n,timeout:window.setTimeout(function(){n&&n(void 0,new Error("IframePhone timed out waiting for reply"))},2e3)},u.post(t,{messageType:"call",uuid:r,value:e})}function l(){u.disconnect()}var f=i()({});e&&"object"===(void 0===e?"undefined":d()(e))&&(t=e.namespace,n=e.targetWindow,s=e.targetOrigin,u=e.phone,e=e.handler),u||(n===window.parent?(u=a(),u.initialize()):u=new r(n,s)),u.addListener(t,function(e){var n;"call"===e.messageType&&"function"==typeof this.handler?this.handler.call(void 0,e.value,function(n){u.post(t,{messageType:"returnValue",uuid:e.uuid,value:n})}):"returnValue"===e.messageType&&(n=f[e.uuid])&&(window.clearTimeout(n.timeout),n.callback&&n.callback.call(void 0,e.value),f[e.uuid]=null)}.bind(this)),this.handler=e,this.call=c.bind(this),this.disconnect=l.bind(this)}},{"./iframe-endpoint":1,"./parent-endpoint":3}],3:[function(e,t,n){var o=e("./structured-clone");t.exports=function(e,t,n){function r(e,n){var r;if(r=1===arguments.length&&"object"===(void 0===e?"undefined":d()(e))&&"string"==typeof e.type?e:{type:e,content:n},h){var i=s();o.supported()?i.postMessage(r,t):i.postMessage(c()(r),t)}else p.push(r)}function i(e,t){v[e]=t}function a(e){v[e]=null}function s(){if(f){var t=e.contentWindow;if(!t)throw"IFrame element needs to be added to DOM before communication can be started (.contentWindow is not available)";return t}return e}function u(e){var n;e.source!==s()||"*"!==t&&e.origin!==t||(n=e.data,"string"==typeof n&&(n=JSON.parse(n)),v[n.type]?v[n.type](n.content):console.log("cant handle type: "+n.type))}function l(){h=!1,window.removeEventListener("message",u)}var f,p=[],h=!1,v={};try{f=e.constructor===HTMLIFrameElement}catch(e){f=!1}return f&&(t&&t.constructor!==Function||(n=t,t=function(e){return e.src.match(/(.*?\/\/.*?)\//)[1]}(e))),"file://"===t&&(t="*"),i("hello",function(){for(h=!0,r({type:"hello",origin:window.location.href.match(/(.*?\/\/.*?)\//)[1]}),n&&"function"==typeof n&&n();p.length>0;)r(p.shift())}),window.addEventListener("message",u,!1),{post:r,addListener:i,removeListener:a,disconnect:l,getTargetWindow:s,targetOrigin:t}}},{"./structured-clone":4}],4:[function(e,t,n){var o=!1;!function(){var e=0;if(window.postMessage)try{window.onmessage=function(t){var n=Object.prototype.toString.call(t.data);e=-1!=n.indexOf("Null")||-1!=n.indexOf("DOMWindow")?1:0,o={structuredClones:e}},window.postMessage(document.createElement("a"),"*")}catch(t){e=t.DATA_CLONE_ERR||"Cannot post cyclic structures."==t.message?1:0,o={structuredClones:e}}}(),n.supported=function(){return o&&o.structuredClones>0}},{}],5:[function(e,t,n){t.exports={ParentEndpoint:e("./lib/parent-endpoint"),getIFrameEndpoint:e("./lib/iframe-endpoint"),structuredClone:e("./lib/structured-clone"),IframePhoneRpcEndpoint:e("./lib/iframe-phone-rpc-endpoint")}},{"./lib/iframe-endpoint":1,"./lib/iframe-phone-rpc-endpoint":2,"./lib/parent-endpoint":3,"./lib/structured-clone":4}]},{},[5])(5)})}).call(t,n(145)(e),n(68))},71:function(e,t,n){"use strict";/**
 * @file This module contains utility functions for accessing MCBKT engine of
 *    <a href="https://ukde.physicsfront.com">UKDE by Physics Front</a>.
 * @copyright (c) 2017, Sam Gweon (Sam@physicsfront.com)
 * @license <a href="https://www.apache.org/licenses/LICENSE-2.0">
 *    Apache License, Version 2.0</a> (also, see file NOTICE).
 * @author Sam Gweon (Sam@physicsfront.com)
 * @version 0.1.0
 * @module mcbkt-client
 */
function o(){var e=window.top.location;return"object"==(void 0===e?"undefined":d()(e))&&(e=e.href),console.log("wtl = "+window.top.location),console.log("wtlh = "+window.top.location.href),!/^https?:\/\/codap.concord.org/.test(e)}function r(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"GET",n=arguments[2],r=arguments[3];if(o())return t=t.toUpperCase(),new c.a(function(o,i){var a=new XMLHttpRequest;if(a.open(t,e),a.onload=function(){return 200===a.status?o(a.response):i(Error(a.statusText))},a.onerror=function(e){return i(Error("Network Error: "+e))},n&&(a.setRequestHeader("Content-Type","application/json;charset=UTF-8"),n=s()(n)),void 0!==r)for(var u in r)a.setRequestHeader(u,r[u]);a.send(n)})}function i(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"https://ukde.physicsfront.com/logdata/codapproxy_stub",n=arguments[2];if(o())return r(t,"post",e,n)}var a=n(27),s=n.n(a),u=n(83),c=n.n(u),l=n(49),d=n.n(l);t.a=i},72:function(e,t,n){"use strict";var o=n(47),r=n(142),i=n(138),a=n.n(i);o.a.use(r.a),t.a=new r.a({routes:[{path:"/",name:"Panel",component:a.a,props:{heading:"",unit_activity_type:"challenge"}}]})},73:function(e,t,n){function o(e){r||n(134)}var r=!1,i=n(46)(n(74),n(140),o,null,null);i.options.__file="/home/gweon/sys/git/mcbkt-plugin/src/App.vue",i.esModule&&Object.keys(i.esModule).some(function(e){return"default"!==e&&"__"!==e.substr(0,2)})&&console.error("named exports are not supported in *.vue files."),i.options.functional&&console.error("[vue-loader] App.vue: functional components are not supported with templates, they should use render functions."),e.exports=i.exports},74:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={created:function(){},name:"app"}},75:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(78),r=n.n(o),i=n(80),a=n.n(i),s=n(48),u=n.n(s);t.default={name:"map_table_h",props:{data:{type:null,default:function(){return[["key 1","value 1"],["key 2","value 2"],["k3"]]},validator:function(e){return void 0!=e[u.a]||(console.log("data must be an iterable."),!1)}},body_tooltip:{type:String,default:""}},data:function(){return{}},computed:{map:function(){return new a.a(this.data)},keys:function(){return r()(this.map.keys()).map(function(e){return""+e})},vals:function(){return r()(this.map.values()).map(function(e){return""+e})}}}},76:function(e,t,n){"use strict";function o(e){return e.charAt(0).toUpperCase()+e.slice(1)}Object.defineProperty(t,"__esModule",{value:!0});var r=n(79),i=n.n(r),a=n(136),s=n.n(a),u=n(137),c=n.n(u);t.default={name:"mckbt-panel",components:{map_table_h:c.a},props:{unit_activity_type:{default:"level",type:String},heading:{default:"Real time MCBKT",type:String},curitem_keys:{default:function(){return["id","cluster","time","npts"]},type:Array},allitems_keys:{default:function(){return["time","npts"]},type:Array}},data:function(){return{all_data:[{id:1,cluster:"A",time:30,npts:5},{id:2,cluster:"B",time:50,npts:10},{id:3,cluster:"C",time:100,npts:10}]}},computed:{body_tooltip_cur:{get:function(){var e=this.all_data;return e&&e.length?e[e.length-1].tooltip||"":""},set:function(){}},curitems:{get:function(){var e=this.all_data,t=this.curitem_keys,n=[];if(e.length){var o=e[e.length-1],r=!0,a=!1,s=void 0;try{for(var u,c=i()(t);!(r=(u=c.next()).done);r=!0){var l=u.value;n.push([l,o[l]||""])}}catch(e){a=!0,s=e}finally{try{!r&&c.return&&c.return()}finally{if(a)throw s}}}else{var d=!0,f=!1,p=void 0;try{for(var h,v=i()(t);!(d=(h=v.next()).done);d=!0){var _=h.value;n.push([_,""])}}catch(e){f=!0,p=e}finally{try{!d&&v.return&&v.return()}finally{if(f)throw p}}}return n},set:function(){}},previtems:{get:function(){var e=this.all_data,t=this.curitem_keys,n=[],o=!0,r=!1,a=void 0;try{for(var s,u=i()(t);!(o=(s=u.next()).done);o=!0){for(var c=s.value,l=[],d=0;d<e.length-1;d++)l.push(e[d][c]);n.push([c+(c.endsWith("s")?"":"s"),l])}}catch(e){r=!0,a=e}finally{try{!o&&u.return&&u.return()}finally{if(r)throw a}}return n},set:function(){}},allitems:{get:function(){var e=this.all_data,t=this.allitems_keys,n=[],o=!0,r=!1,a=void 0;try{for(var s,u=i()(t);!(o=(s=u.next()).done);o=!0){for(var c=s.value,l=0,d=0;d<e.length;d++)l+=e[d][c];n.push([c,l||""])}}catch(e){r=!0,a=e}finally{try{!o&&u.return&&u.return()}finally{if(r)throw a}}return n},set:function(){}}},created:function(){var e=this;this.all_data=[],window.mcbkt_fit_consumer=function(t){var n=t.times||[],o=t.cluster||"",r=t.reffv_list||[],a=n.length,s=a?Math.round(n[a-1]-n[0]+3):"",u=r.length?r[r.length-1]:"",c=[],l=!0,d=!1,f=void 0;try{for(var p,h=i()(e.all_data);!(l=(p=h.next()).done);l=!0){var v=p.value;c.push(v.id)}}catch(e){d=!0,f=e}finally{try{!l&&h.return&&h.return()}finally{if(d)throw f}}var _=t.cluster_long||"",m=t.cluster_description||"",g="";_&&m&&(g=_+" : "+m);var w=void 0;w=r.join(",")===c.join(",")?e.all_data.slice(0,e.all_data.length-1):e.all_data,e.all_data=w.concat({id:u,cluster:o,time:s,npts:a,tooltip:g})}},methods:{add_new_data:function(){},replace_last_data:function(){},unregister_logdata_listener:function(){},register_mcbkt_client:function(e){},unregister_mcbkt_client:function(e){}},filters:{capitalize:o,pluralize:function(e){return s()(e,10)},capitalize_all:function(e){return e.split(" ").map(o).join(" ")}}}},77:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(47),r=n(73),i=n.n(r),a=n(72),s=n(71),u=n(70),c=n(69);/**
 * @file This app is a data interactive plugin that mediates the MCBKT
 *    engine service to the CODAP data interactive such as Ramp Game.
 *
 * @copyright (c) 2017, Physics Front LLC (main@physicsfront.com)
 * @license <a href="https://www.apache.org/licenses/LICENSE-2.0">
 *    Apache License, Version 2.0</a> (also, see file NOTICE).
 * @author Sam Gweon (Sam@physicsfront.com)
 * @version 0.1.0
 */
if(!window.iframePhone){if(!u.default)throw Error('Failed to load module "iframePhone".');window.iframePhone=u.default}Object.defineProperty(o.a.prototype,"$iframePhone",{value:window.iframePhone}),window.logdataListener=new c.a(window.iframePhone,function(e,t){e.application="CODAP",e.activity="Ramp Game 2017 09",n.i(s.a)(e).then(function(e){var t=JSON.parse(e);t.answer&&window.mcbkt_fit_consumer&&window.mcbkt_fit_consumer(t)},function(){}).catch(function(){})}),Object.defineProperty(o.a.prototype,"$logdataListener",{value:window.logdataListener}),o.a.config.productionTip=!1,new o.a({el:"#app",router:a.a,template:"<App/>",components:{App:i.a}})}},[77]);
//# sourceMappingURL=app.10c48e7ad76d783ade74.js.map